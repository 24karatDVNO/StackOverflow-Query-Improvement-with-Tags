<p>This is rather complicated in SQL. If you have access to Safari Books, there are some relevant sections in <em>Joe Celko's Trees and Hierarchies in SQL for Smarties</em>.</p>