<p>Maybe this will work:</p>

<p><a href="http://htmlpurifier.org/" rel="nofollow">http://htmlpurifier.org/</a></p>

<p>Here is tutorial</p>

<p><a href="http://www.zendcasts.com/writing-custom-zend-filters-with-htmlpurifier/2011/06/" rel="nofollow">http://www.zendcasts.com/writing-custom-zend-filters-with-htmlpurifier/2011/06/</a></p>

<p>it's for Zend Framework but I think it may helps</p>