<p>the problem of 64/32 bit versions is a little more complicated, as you might be running a 32bit photoshop on a 32 bit OS.
I would try for the sake of testing to set the project target to x64 and if that can run the photoshop64, than you might even make your code compile twice (2 dlls) and load them according to the photoshop version.  </p>