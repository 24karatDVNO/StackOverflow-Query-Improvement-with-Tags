<p>You can't safely pass exception through C interfaces (like CreateDialog, DispatchMessage etc..). You must catch them all before they escape from the window procedure, transfer them somehow to the caller, and then rethrow them from there. You can do it generically in C++0x, but you probably don't have support for it yet. Try using <code>boost::exceptions</code> to approximate it in C++03.</p>