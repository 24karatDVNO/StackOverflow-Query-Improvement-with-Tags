<p>Thanks for everybody's help on this question. I was unable to find a solution that would work well for this applications situation without the need for masses of code.</p>

<p>To get around the issue I looked at the default MVC 2 project and copied some of Microsoft's code. My project is probably not very testable but I needed a quick solution. I've set it up so that if I do have time to find a solution in the future, I'll be able to replace it with the current code.</p>