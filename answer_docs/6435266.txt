<p>A little more streamlined way of doing it would be to check the result set before you even get into looping the array.  That way you can skip all that if its empty and go straight to the empty dialogue.</p>