<p>My addin was COM AddIn which is not possible to have range.value2 different from range.formula
no matter it is C# or VB.NET.</p>

<p>This can be done using VBA, Automation AddIn in .NET, or xll addin. 
For xll addin, you can either write in C/C++, or use existing tools like ExcelDNA, managedXLL, XLW, etc.</p>