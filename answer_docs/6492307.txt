<p>What is the purpose of your return statements?  I don't see a point in having them where they are and returning nothing.  If you take them out, your unexpected behavior may go away.</p>