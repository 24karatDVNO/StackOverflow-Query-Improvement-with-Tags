<p>i have a small hunch. might be wrong but based upon the crazy runtime and small dataset. try to add </p>

<pre><code>LIMIT 1
</code></pre>

<p>to your sub query.</p>