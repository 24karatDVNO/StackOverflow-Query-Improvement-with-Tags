<p>The problem wasn't the code. The code is good. It was faulty connection - RS232 cable. Since it's been replaced everything works great. Thanks everyone for your help.</p>