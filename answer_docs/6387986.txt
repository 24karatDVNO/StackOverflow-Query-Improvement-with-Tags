<p>Your design so far looks great. Here's my opinion: The problem you are facing with the blur command is an indicator of more such things to come and therefore addition of more such commands should be built into your design. You can therefore create two sub-classes for Command - <code>FastCommand</code> and <code>SlowCommand</code>. FastCommand has only the <code>doIt</code> and <code>undoIt</code> methods and will simply execute and add it to the command stack. SlowCommand should be an <strong>asynchronous</strong> command with a two step process for doing things - preview &amp; commit. First time you execute a SlowCommand it should be executed but not added to the command stack. Instead, just keep it in the workspace as a reference. When the user actually confirms the action, execute it again (this time it does the real thing) and then move it to the command stack. </p>

<p>The View class is probably not required.</p>

<p>Coming to the actual undo-redo mechanism for the SlowCommand, you can decide on the best approach based on performance and available memory - create a buffer copy and then discarding it, or maybe running the inverse algorithm on the same buffer. If you find that you are using both the strategies in your application, a <a href="http://www.oodesign.com/strategy-pattern.html" rel="nofollow">Strategy Pattern</a> could be used inside the Command.</p>