<p>I would consider to use something like <strong>Abstract Factory</strong> pattern. It is very
useful in relation to IoC because it can encapsulate complex logic that creates other Dependencies. Then you could inject your abstract factory with a IoC tool and get a rid of the switch statement.</p>