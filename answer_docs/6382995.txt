<p>Maybe you could try using the <code>fstatvfs()/statvfs()</code> system calls to get the amount of free disk space instead, and see if that makes any difference.</p>