<p>Here you can find some code on how to open the filewall port yourself in C# code <a href="http://www.shafqatahmed.com/2008/01/controlling-win.html" rel="nofollow">http://www.shafqatahmed.com/2008/01/controlling-win.html</a>
Of course your app must be running elevated in order to do this.</p>

<p>There are several installers on the web too which offer this functionality. For example (unfortunately not open source): uTorrent's installer. </p>