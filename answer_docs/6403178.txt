<p>If I understand it well, your problem is the famous <strong>group-wise maximum in SQL</strong>. It has already been asked on StackOverflow, for instance <a href="https://stackoverflow.com/questions/612231/how-can-i-select-rows-with-maxcolumn-value-distinct-by-another-column-in-sql">here</a></p>

<p>There's also a dedicated page for this in the <a href="http://dev.mysql.com/doc/refman/5.1/en/example-maximum-column-group-row.html" rel="nofollow noreferrer">MySQL manual</a>, as well as many blog posts, like this high-level <a href="http://explainextended.com/2009/11/24/mysql-selecting-records-holding-group-wise-maximum-on-a-unique-column/" rel="nofollow noreferrer">post</a>.</p>