<p>I don't know the bigger picture of what you are trying to achieve, but I would highly recommend checking out an authentication gem like Devise.</p>

<p><a href="https://github.com/plataformatec/devise" rel="nofollow">https://github.com/plataformatec/devise</a></p>

<p>It is a lot of work to handle authentication properly (and securely), and unless you have unique circumstances, it's likely not worth the time to reinvent the wheel here.</p>

<p>Also, Devise handles your mentioned functionality well.</p>