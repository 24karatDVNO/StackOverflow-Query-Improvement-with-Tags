<p>One way would be to do the work of anonymous function
on the <em>lua side</em> and pass the result of function to 
<code>FOO(int, char*, fun_result_type fun_result)</code></p>