<p>There's no point in profiling this - it's just the wrong approach. You're doing a separate IMAP request and data transfer for every message, which will never be fast. The most efficient way is not to do it here at all - Get the IMAP server to do the search for you. It's probably not quite as flexible as what you're doing, but it will have no trouble searching tens of thousands of messages per second, and it can certainly do a simple string match in message bodies. <a href="http://www.php.net/manual/en/function.imap-search.php" rel="nofollow">PHP has support for searching inboxes</a> in the IMAP extension. I don't know if that function is exposed via any of the Zend components, but it doesn't really matter if it isn't.</p>

<p>This is exactly the mechanism that iPhone inbox search uses; It does local search on messages that it already has, but then offers the option to continue the search on the server, which hands-off to something that's already got the data and has more horsepower to bring to bear.</p>