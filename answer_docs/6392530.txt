<p>Not sure what causes the crash in your case. My guess that it must be a buffer overrun problem. Do you consider space for the ending <code>\0</code> character in MAX_PATH constant?</p>