<p>I strongly recommend investing some time to read <a href="http://www.dabeaz.com/generators/Generators.pdf" rel="nofollow"><em>Generator Tricks for Systems Programmers</em></a>(PDF). It's from a presentation at PyCon 08 and it deals specifically with processing arbitrarily large log files. The reversal aspect is an interesting wrinkle, but the rest of the presentation should speak directly to your problem.</p>