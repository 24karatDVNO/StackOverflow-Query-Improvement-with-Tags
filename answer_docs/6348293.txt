<p>For the polygons I think you have to first loop through the rings of the polygons to find polylines and then you can examine the polylines as you do in your code. </p>

<p>Sorry I cannot help you any further since I don't have ArcGIS installed (and it is all long time ago I worked with ArcGIS). You might get better response on <a href="http://gis.stackexchange.com">gis.stackexchange.com</a>.</p>