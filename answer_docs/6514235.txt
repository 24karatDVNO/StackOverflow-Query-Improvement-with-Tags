<p>You could build a state machine that takes into account the ordering requirements, annotate the transitions with your weights, and solve the traveling salesman on that. Except you'd have a lot more nodes: 2^(number of capitals) times the original number of nodes.</p>