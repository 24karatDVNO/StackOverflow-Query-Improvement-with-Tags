<p>This isn't a direct answer to your question, but perhaps instead of a <code>Rectangle</code> you could use a <code>ToggleButton</code> and declaratively apply styling based on the <code>IsChecked</code> property?</p>