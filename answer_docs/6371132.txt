<p>Ram confirmed that the keys in the registry has to be in the Wow6432node and I then found that compiling as x86 and using the code I already had meant that it would look under the Wow6432node for the keys.</p>