<p>Don't ever trust user input. Checking for a given filetype/mimetype should never be used as a way to prevent people from uploading malicious content to your server. If the goal is server security, then simply don't allow content to be executed on the server if it's uploaded by a user. For files that other people download, make sure to place a disclaimer that the content was user-generated and is not guaranteed to be virus-free. </p>