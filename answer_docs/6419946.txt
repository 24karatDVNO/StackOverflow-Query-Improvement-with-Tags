<p>You may find the Monitored Undo Framework to be useful. <a href="http://muf.codeplex.com/" rel="nofollow">http://muf.codeplex.com/</a></p>

<p>It doesn't use the "top down" command pattern, but instead monitors for changes as they happen and allows you to put a delegate on the undo stack that will reverse the change. You can find more info and documentaiton on the codeplex site.</p>